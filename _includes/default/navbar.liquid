<header class="site-header">

    <!-- Logo and title -->
    <div class="branding">
        {% if site.avatar %}
        <a href="{{ '/' | relative_url }}">
            <img alt="logo img" class="avatar" src="{{ site.avatar | relative_url }}" loading="lazy"/>
        </a>
        {% endif %}
        <a class="site-title" aria-label="{{ site.title }}" href="{{ '/' | relative_url }}">
        {{ site.title }}
        </a>
    </div>

    <!-- Toggle menu button -->
    <a aria-label="pull" id="pull" class="toggle" href="#">
    <i class="fa-solid fa-bars fa-lg"></i>
    </a>

    <!-- Navigation menu -->
    <nav class="clear">
    <ul class="hide">
        {% assign name_page = "" %}

        <!-- First pass: render non-icon pages -->
        {% for page in site.pages %}
            {% unless page.title == null or page.hide or name_page contains page.title %}
                {% unless page.icon %}
                    <li class="separator"> | </li>
                    <li>
                        <a class="clear" aria-label="{{ page.title }}" title="{{ page.title }}" href="{{ page.url | relative_url }}">
                            {{ page.title }}
                        </a>
                    </li>
                {% endunless %}
            {% endunless %}
            {% assign name_page = page.title | append: name_page %}
        {% endfor %}

        <!-- Second pass: render icon pages and theme-toggle grouped together in a single li -->
        <li class="separator"> | </li>
        <li class="icon-menu-group">
            {% assign name_page_icons = "" %}
            {% for page in site.pages %}
                {% unless page.title == null or page.hide or name_page_icons contains page.title %}
                    {% if page.icon %}
                        <a class="clear icon-menu-item" aria-label="{{ page.title }}" title="{{ page.title }}" href="{{ page.url | relative_url }}">
                            <i class="fa-solid {{ page.icon }}" aria-hidden="true"></i>
                        </a>
                    {% endif %}
                {% endunless %}
                {% if page.icon %}
                    {% assign name_page_icons = page.title | append: name_page_icons %}
                {% endif %}
            {% endfor %}
            
            {% if site.color_theme == 'auto' %}
            {% assign lang = site.data.language.cusdis_lang | default: "en" %}
            {% assign lang_data = site.data.language[lang] %}
            {% assign next_mode = "system" %}
            {% assign switch_to_text = lang_data.str_switch_to | default: "Switch to" %}
            {% assign system_text = lang_data.str_system | default: "System" %}
            <a id="theme-toggle" class="clear icon-menu-item" title="{{ switch_to_text }} {{ system_text }}" aria-label="{{ switch_to_text }} {{ system_text }}" onclick="themeToggle()"></a>
            {% endif %}
        </li>
    </ul>

    </nav>
</header>