
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>32-8 Ferromagnetism &#8212; Fluids, Waves, Thermodynamics, and Optics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../static/custom.css?v=b4de26a8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../static/doctools.js?v=9a2dae69"></script>
    <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../static/copybutton.js?v=f281be69"></script>
    <script src="../static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch32_maxwells-equations/32-8-ferromagnetism';</script>
    <link rel="canonical" href="https://everettyou.github.io/teaching/PHYS2C/notes/ch32_maxwells-equations/32-8-ferromagnetism.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chap 33: Electromagnetic Waves" href="../ch33_electromagnetic-waves/index.html" />
    <link rel="prev" title="32-7 Paramagnetism" href="32-7-paramagnetism.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <link rel="icon" href="https://everettyou.github.io/assets/img/logos/avatar.svg" type="image/svg+xml"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Fluids, Waves, Thermodynamics, and Optics</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    PHYS 2C Lecture Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch14_fluids/index.html">Chap 14: Fluids</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-1-fluids-density-and-pressure.html">14-1 Fluids, Density, and Pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-2-fluids-at-rest.html">14-2 Fluids at Rest</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-3-measuring-pressure.html">14-3 Measuring Pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-4-pascals-principle.html">14-4 Pascal’s Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-5-archimedes-principle.html">14-5 Archimedes’ Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-6-the-equation-of-continuity.html">14-6 The Equation of Continuity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch14_fluids/14-7-bernoullis-equation.html">14-7 Bernoulli’s Equation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch15_oscillations/index.html">Chap 15: Oscillations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-1-simple-harmonic-motion.html">15-1 Simple Harmonic Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-2-energy-in-simple-harmonic-motion.html">15-2 Energy in Simple Harmonic Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-3-an-angular-simple-harmonic-oscillator.html">15-3 An Angular Simple Harmonic Oscillator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-4-pendulums-circular-motion.html">15-4 Pendulums, Circular Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-5-damped-simple-harmonic-motion.html">15-5 Damped Simple Harmonic Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch15_oscillations/15-6-forced-oscillations-and-resonance.html">15-6 Forced Oscillations and Resonance</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch16_waves_i/index.html">Chap 16: Waves—I</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-1-transverse-waves.html">16-1 Transverse Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-2-wave-speed-on-a-stretched-string.html">16-2 Wave Speed on a Stretched String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-3-energy-and-power-of-a-wave-traveling-along-a-string.html">16-3 Energy and Power of a Wave Traveling Along a String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-4-the-wave-equation.html">16-4 The Wave Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-5-interference-of-waves.html">16-5 Interference of Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-6-phasors.html">16-6 Phasors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch16_waves_i/16-7-standing-waves-and-resonance.html">16-7 Standing Waves and Resonance</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch17_waves_ii/index.html">Chap 17: Waves—II</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-1-speed-of-sound.html">17-1 Speed of Sound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-2-traveling-sound-waves.html">17-2 Traveling Sound Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-3-interference.html">17-3 Interference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-4-intensity-and-sound-level.html">17-4 Intensity and Sound Level</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-5-sources-of-musical-sound.html">17-5 Sources of Musical Sound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-6-beats.html">17-6 Beats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-7-the-doppler-effect.html">17-7 The Doppler Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch17_waves_ii/17-8-supersonic-speeds-shock-waves.html">17-8 Supersonic Speeds, Shock Waves</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch18_temperature-heat-first-law/index.html">Chap 18: Temperature, Heat, and the First Law of Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-1-temperature.html">18-1 Temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-2-the-celsius-and-fahrenheit-scales.html">18-2 The Celsius and Fahrenheit Scales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-3-thermal-expansion.html">18-3 Thermal Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-4-absorption-of-heat.html">18-4 Absorption of Heat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-5-the-first-law-of-thermodynamics.html">18-5 The First Law of Thermodynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch18_temperature-heat-first-law/18-6-heat-transfer-mechanisms.html">18-6 Heat Transfer Mechanisms</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch19_kinetic-theory/index.html">Chap 19: The Kinetic Theory of Gases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-1-avogadros-number.html">19-1 Avogadro’s Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-2-ideal-gases.html">19-2 Ideal Gases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-3-pressure-temperature-and-rms-speed.html">19-3 Pressure, Temperature, and RMS Speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-4-translational-kinetic-energy.html">19-4 Translational Kinetic Energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-5-mean-free-path.html">19-5 Mean Free Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-6-the-distribution-of-molecular-speeds.html">19-6 The Distribution of Molecular Speeds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-7-the-molar-specific-heats-of-an-ideal-gas.html">19-7 The Molar Specific Heats of an Ideal Gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-8-degrees-of-freedom-and-molar-specific-heats.html">19-8 Degrees of Freedom and Molar Specific Heats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch19_kinetic-theory/19-9-the-adiabatic-expansion-of-an-ideal-gas.html">19-9 The Adiabatic Expansion of an Ideal Gas</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch20_entropy-second-law/index.html">Chap 20: Entropy and the Second Law of Thermodynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch20_entropy-second-law/20-1-entropy.html">20-1 Entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch20_entropy-second-law/20-2-entropy-in-the-real-world-engines.html">20-2 Entropy in the Real World: Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch20_entropy-second-law/20-3-refrigerators-and-real-engines.html">20-3 Refrigerators and Real Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch20_entropy-second-law/20-4-a-statistical-view-of-entropy.html">20-4 A Statistical View of Entropy</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Chap 32: Maxwell’s Equations; Magnetism of Matter</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="32-1-gauss-law-for-magnetic-fields.html">32-1 Gauss’ Law for Magnetic Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-2-induced-magnetic-fields.html">32-2 Induced Magnetic Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-3-displacement-current.html">32-3 Displacement Current</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-4-magnets.html">32-4 Magnets</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-5-magnetism-and-electrons.html">32-5 Magnetism and Electrons</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-6-diamagnetism.html">32-6 Diamagnetism</a></li>
<li class="toctree-l2"><a class="reference internal" href="32-7-paramagnetism.html">32-7 Paramagnetism</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">32-8 Ferromagnetism</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch33_electromagnetic-waves/index.html">Chap 33: Electromagnetic Waves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-1-electromagnetic-waves.html">33-1 Electromagnetic Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-2-energy-transport-and-the-poynting-vector.html">33-2 Energy Transport and the Poynting Vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-3-radiation-pressure.html">33-3 Radiation Pressure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-4-polarization.html">33-4 Polarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-5-reflection-and-refraction.html">33-5 Reflection and Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-6-total-internal-reflection.html">33-6 Total Internal Reflection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch33_electromagnetic-waves/33-7-polarization-by-reflection.html">33-7 Polarization by Reflection</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch34images/index.html">Chap 34: Images</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-1-images-and-plane-mirrors.html">34-1 Images and Plane Mirrors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-2-spherical-mirrors.html">34-2 Spherical Mirrors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-3-spherical-refracting-surfaces.html">34-3 Spherical Refracting Surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-4-thin-lenses.html">34-4 Thin Lenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-5-optical-instruments.html">34-5 Optical Instruments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch34images/34-6-three-proofs.html">34-6 Three Proofs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch35_interference/index.html">Chap 35: Interference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch35_interference/35-1-light-as-a-wave.html">35-1 Light as a Wave</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35_interference/35-2-youngs-interference-experiment.html">35-2 Young’s Interference Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35_interference/35-3-interference-and-double-slit-intensity.html">35-3 Interference and Double-Slit Intensity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35_interference/35-4-interference-from-thin-films.html">35-4 Interference from Thin Films</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch35_interference/35-5-michelsons-interferometer.html">35-5 Michelson’s Interferometer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch36_diffraction/index.html">Chap 36: Diffraction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-1-single-slit-diffraction.html">36-1 Single-Slit Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-2-intensity-in-single-slit-diffraction.html">36-2 Intensity in Single-Slit Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-3-diffraction-by-a-circular-aperture.html">36-3 Diffraction by a Circular Aperture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-4-diffraction-by-a-double-slit.html">36-4 Diffraction by a Double Slit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-5-diffraction-gratings.html">36-5 Diffraction Gratings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-6-gratings-dispersion-and-resolving-power.html">36-6 Gratings: Dispersion and Resolving Power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch36_diffraction/36-7-x-ray-diffraction.html">36-7 X-Ray Diffraction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch37_relativity/index.html">Chap 37: Relativity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-1-simultaneity-and-time-dilation.html">37-1 Simultaneity and Time Dilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-2-the-relativity-of-length.html">37-2 The Relativity of Length</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-3-the-lorentz-transformation.html">37-3 The Lorentz Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-4-the-relativity-of-velocities.html">37-4 The Relativity of Velocities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-5-doppler-effect-for-light.html">37-5 Doppler Effect for Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch37_relativity/37-6-momentum-and-energy.html">37-6 Momentum and Energy</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch38_photons-matter-waves/index.html">Chap 38: Photons and Matter Waves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-1-the-photon-the-quantum-of-light.html">38-1 The Photon, the Quantum of Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-2-the-photoelectric-effect.html">38-2 The Photoelectric Effect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-3-photons-momentum-compton-scattering-light-interference.html">38-3 Photons, Momentum, Compton Scattering, Light Interference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-4-the-birth-of-quantum-physics.html">38-4 The Birth of Quantum Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-5-electrons-and-matter-waves.html">38-5 Electrons and Matter Waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-6-schrodingers-equation.html">38-6 Schrödinger’s Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-7-heisenbergs-uncertainty-principle.html">38-7 Heisenberg’s Uncertainty Principle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-8-reflection-from-a-potential-step.html">38-8 Reflection from a Potential Step</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch38_photons-matter-waves/38-9-tunneling-through-a-potential-barrier.html">38-9 Tunneling Through a Potential Barrier</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch39_more-about-matter-waves/index.html">Chap 39: More About Matter Waves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch39_more-about-matter-waves/39-1-energies-of-a-trapped-electron.html">39-1 Energies of a Trapped Electron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39_more-about-matter-waves/39-2-wave-functions-of-a-trapped-electron.html">39-2 Wave Functions of a Trapped Electron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39_more-about-matter-waves/39-3-an-electron-in-a-finite-well.html">39-3 An Electron in a Finite Well</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39_more-about-matter-waves/39-4-two-and-three-dimensional-electron-traps.html">39-4 Two- and Three-Dimensional Electron Traps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch39_more-about-matter-waves/39-5-the-hydrogen-atom.html">39-5 The Hydrogen Atom</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch40_all-about-atoms/index.html">Chap 40: All About Atoms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-1-properties-of-atoms.html">40-1 Properties of Atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-2-the-stern-gerlach-experiment.html">40-2 The Stern-Gerlach Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-3-magnetic-resonance.html">40-3 Magnetic Resonance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-4-exclusion-principle-and-multiple-electrons-in-a-trap.html">40-4 Exclusion Principle and Multiple Electrons in a Trap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-5-building-the-periodic-table.html">40-5 Building the Periodic Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-6-x-rays-and-the-ordering-of-the-elements.html">40-6 X Rays and the Ordering of the Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch40_all-about-atoms/40-7-lasers.html">40-7 Lasers</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch42_nuclear-physics/index.html">Chap 42: Nuclear Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-1-discovering-the-nucleus.html">42-1 Discovering the Nucleus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-2-some-nuclear-properties.html">42-2 Some Nuclear Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-3-radioactive-decay.html">42-3 Radioactive Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-4-alpha-decay.html">42-4 Alpha Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-5-beta-decay.html">42-5 Beta Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-6-radioactive-dating.html">42-6 Radioactive Dating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-7-measuring-radiation-dosage.html">42-7 Measuring Radiation Dosage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch42_nuclear-physics/42-8-nuclear-models.html">42-8 Nuclear Models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ch43_energy-from-nucleus/index.html">Chap 43: Energy from the Nucleus</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-1-nuclear-fission.html">43-1 Nuclear Fission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-2-the-nuclear-reactor.html">43-2 The Nuclear Reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-3-a-natural-nuclear-reactor.html">43-3 A Natural Nuclear Reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-4-thermonuclear-fusion-the-basic-process.html">43-4 Thermonuclear Fusion: The Basic Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-5-thermonuclear-fusion-in-the-sun-and-other-stars.html">43-5 Thermonuclear Fusion in the Sun and Other Stars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ch43_energy-from-nucleus/43-6-controlled-thermonuclear-fusion.html">43-6 Controlled Thermonuclear Fusion</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/EverettYou/everettyou.github.io/master?urlpath=tree/teaching/PHYS2C/notes_src/ch32_maxwells-equations/32-8-ferromagnetism.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/EverettYou/everettyou.github.io/blob/master/teaching/PHYS2C/notes_src/ch32_maxwells-equations/32-8-ferromagnetism.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../sources/ch32_maxwells-equations/32-8-ferromagnetism.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>32-8 Ferromagnetism</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-notes">Lecture Notes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curie-temperature">Curie temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis">Hysteresis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-the-memory-of-magnets">Project: The Memory of Magnets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-model">Explore the Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-1-spin-configuration">Experiment 1: Spin configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-2-hysteresis-loop">Experiment 2: Hysteresis loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-3-curieweiss-law">Experiment 3: Curie–Weiss law</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  
<style>
  .ss-layout-default-AB { grid-template-areas: 'A B'; }
</style>
<section class="tex2jax_ignore mathjax_ignore" id="ferromagnetism">
<h1>32-8 Ferromagnetism<a class="headerlink" href="#ferromagnetism" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Prompts</p>
<ul class="simple">
<li><p>What is exchange coupling in ferromagnetism? Why does ferromagnetism disappear above the Curie temperature?</p></li>
<li><p>What are magnetic domains? How do they explain hysteresis and the shape of a hysteresis loop?</p></li>
<li><p>For a ferromagnetic sample at a given <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, compare the energy of dipole orientations with thermal energy. Why does heating reduce magnetization?</p></li>
<li><p>What is a metastable state? How does it relate to hysteresis?</p></li>
</ul>
</div>
<section id="lecture-notes">
<h2>Lecture Notes<a class="headerlink" href="#lecture-notes" title="Link to this heading">#</a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Ferromagnetic materials</strong>: Iron, nickel, cobalt, and certain alloys</p></li>
<li><p><strong>Strong magnetization</strong>: Dipoles align and <strong>remain aligned</strong> after <span class="math notranslate nohighlight">\(\vec{B}_{\text{ext}}\)</span> is removed</p></li>
<li><p><strong>Exchange coupling</strong>: Quantum mechanical interaction that locks neighboring dipoles parallel</p></li>
<li><p><strong>Domains</strong>: Regions of aligned dipoles; domain walls separate differently oriented domains</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="curie-temperature">
<h3>Curie temperature<a class="headerlink" href="#curie-temperature" title="Link to this heading">#</a></h3>
<p>For the 2D square lattice Ising model with coupling <span class="math notranslate nohighlight">\(J=1\)</span>, <span class="math notranslate nohighlight">\(T_c \approx 2.27\,J\)</span>.</p>
<p><strong>Curie–Weiss law</strong> (above <span class="math notranslate nohighlight">\(T_c\)</span>): For small fields <span class="math notranslate nohighlight">\(B\)</span>, magnetization responses as</p>
<div class="math notranslate nohighlight" id="equation-eq-curie-weiss">
<span class="eqno">(211)<a class="headerlink" href="#equation-eq-curie-weiss" title="Link to this equation">#</a></span>\[
M \propto \frac{B}{T - T_c}
\]</div>
<p>Diverge as <span class="math notranslate nohighlight">\(T \to T_c^+\)</span>, signaling the onset of ferromagnetic order.</p>
<ul class="simple">
<li><p><strong>Above Curie temperature</strong> <span class="math notranslate nohighlight">\(T_c\)</span>: Above the Curie temperature, ferromagnetism <strong>disappears</strong>; material becomes paramagnetic</p></li>
<li><p><strong>Below</strong> <span class="math notranslate nohighlight">\(T_c\)</span>: Domains can form; material can retain magnetization (ferrormagnetic)</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Physical intuition</p>
<p>Spin exchange coupling (interaction) favors parallel alignment. Thermal energy <span class="math notranslate nohighlight">\(k_B T\)</span> favors randomization. When <span class="math notranslate nohighlight">\(k_B T \gtrsim\)</span> spin interaction energy, alignment is destroyed.</p>
</div>
</section>
<hr class="docutils" />
<section id="hysteresis">
<h3>Hysteresis<a class="headerlink" href="#hysteresis" title="Link to this heading">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<figure class="align-default" id="fig-hysteresis">
<a class="reference internal image-reference" href="../images/32-8_hysteresis.png"><img alt="../images/32-8_hysteresis.png" src="../images/32-8_hysteresis.png" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text"><span class="math notranslate nohighlight">\(M\)</span> vs <span class="math notranslate nohighlight">\(B\)</span> hysteresis loop showing remanence <span class="math notranslate nohighlight">\(M_r\)</span> and coercive field <span class="math notranslate nohighlight">\(B_c\)</span>.</span><a class="headerlink" href="#fig-hysteresis" title="Link to this image">#</a></p>
</figcaption>
</figure>
</aside>
<div class="docutils">
<p><strong>Hysteresis loop</strong>: <span class="math notranslate nohighlight">\(M\)</span> depends on <em>history</em> of applied field, not just current value. Cycling <span class="math notranslate nohighlight">\(B\)</span> traces a loop:</p>
<ul class="simple">
<li><p><strong>Remanence</strong> <span class="math notranslate nohighlight">\(M_r\)</span>: Magnetization when <span class="math notranslate nohighlight">\(B = 0\)</span> (after saturation). It measures how strongly the material retains magnetization once the field is removed.</p></li>
<li><p><strong>Coercivity</strong> <span class="math notranslate nohighlight">\(B_c\)</span>: Field needed to reduce <span class="math notranslate nohighlight">\(M\)</span> to zero. It characterizes how hard it is to <em>reverse</em> the magnetization.</p></li>
</ul>
<p><strong>Applications</strong>:</p>
<ul class="simple">
<li><p>Permanent magnets (high <span class="math notranslate nohighlight">\(M_r\)</span>, <span class="math notranslate nohighlight">\(B_c\)</span>).</p></li>
<li><p>Transformer cores (low <span class="math notranslate nohighlight">\(B_c\)</span>).</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Metastable states and hysteresis</p>
<p>Hysteresis reflects <strong>metastable states</strong>: the system can get “stuck” in a magnetization that is not the unique equilibrium under the external field. Think of a ball in a shallow bowl—it stays until you push hard enough; then it rolls to a lower state. Domain walls and pinning create energy barriers, so <span class="math notranslate nohighlight">\(M\)</span> does not instantly follow the external field <span class="math notranslate nohighlight">\(B\)</span>.</p>
</div>
</div>
</section>
<hr class="docutils" />
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Ferromagnetism</strong>: Exchange coupling aligns dipoles; strong, persistent magnetization</p></li>
<li><p><strong>Curie temperature</strong> <span class="math notranslate nohighlight">\(T_c\)</span>: Above <span class="math notranslate nohighlight">\(T_c\)</span>, ferromagnetism is lost</p></li>
<li><p><strong>Domains</strong>: Regions of aligned dipoles; hysteresis from domain reorientation</p></li>
<li><p><strong>Hysteresis loop</strong>: <span class="math notranslate nohighlight">\(M\)</span> depends on history; remanence and coercivity characterize the loop</p></li>
<li><p><strong>Torque and force</strong>: See 32-6 Diamagnetism for the unified discussion (ferromagnetic samples attracted to stronger field)</p></li>
</ul>
</section>
</section>
<section id="project-the-memory-of-magnets">
<h2>Project: The Memory of Magnets<a class="headerlink" href="#project-the-memory-of-magnets" title="Link to this heading">#</a></h2>
<p><strong>Why does a magnet “remember” which way it was magnetized?</strong> After you remove the external field, the magnetization persists—as if the material holds a memory. That memory is not stored in any single atom. It is a <strong>collective phenomenon</strong>.</p>
<aside class="seealso sidebar">
<p class="sidebar-title">From magnets to machine learning</p>
<p>The idea that collective spin systems can “remember” states inspired the <strong>Hopfield model</strong> (1982)—an early neural network where memories are stored by learned Ising couplings. John Hopfield and Geoffrey Hinton were awarded the <strong>2024 Nobel Prize in Physics</strong> for foundational discoveries in artificial neural networks.</p>
<figure class="sphinx-subfigure align-default" id="fig-nobel-laureates">
<div class="sphinx-subfigure-grid ss-layout-default-AB" style="display: grid;">
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: A;">
<span class="caption">John J. Hopfield</span>
<a class="reference internal image-reference" href="../images/hopfield-2024.jpg"><img alt="John J. Hopfield" src="../images/hopfield-2024.jpg" style="width: 100%;" />
</a>
</div>
<div class="sphinx-subfigure-area" style="display: flex; flex-direction: column; justify-content: center; align-items: center; grid-area: B;">
<span class="caption">Geoffrey Hinton</span>
<a class="reference internal image-reference" href="../images/hinton-2024.jpg"><img alt="Geoffrey Hinton" src="../images/hinton-2024.jpg" style="width: 100%;" />
</a>
</div>
</div>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">John J. Hopfield and Geoffrey Hinton — 2024 Nobel Prize in Physics. <em>Photos: © Nobel Prize Outreach. <a class="reference external" href="https://www.nobelprize.org/prizes/physics/2024/summary/">Source</a></em></span><a class="headerlink" href="#fig-nobel-laureates" title="Link to this image">#</a></p>
</figcaption>
</figure>
</aside>
<p>Each atom carries a magnetic spin. In a ferromagnet, neighboring spins <em>talk</em> to each other: they prefer to align. When one spin flips—a random thermal fluctuation—its neighbors pull it back. The majority consensus holds. This self-reinforcing feedback acts like error correction: stray spin flips are resisted and corrected by the collective. The “memory” is the consensus of millions of spins making a collective decision.</p>
<p>To simulate this, we need a minimal model. The <strong>Ising model</strong>: each site has a spin ↑ or ↓; neighbors prefer to align; an external field <span class="math notranslate nohighlight">\(B\)</span> favors one direction.</p>
<div class="math notranslate nohighlight" id="equation-eq-ising-energy">
<span class="eqno">(212)<a class="headerlink" href="#equation-eq-ising-energy" title="Link to this equation">#</a></span>\[
E = -J \sum_{\langle i,j \rangle} s_i s_j - h \sum_i s_i
\]</div>
<p><strong>Ising variables:</strong> <span class="math notranslate nohighlight">\(s_i = \pm 1\)</span> at each site <span class="math notranslate nohighlight">\(i\)</span>; <span class="math notranslate nohighlight">\(\langle i,j \rangle\)</span> denotes nearest-neighbor pairs.</p>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(J &gt; 0\)</span>:</strong> Ferromagnetic coupling—neighbors prefer to align (parallel spins lower the energy).</p></li>
<li><p><strong><span class="math notranslate nohighlight">\(h \propto B\)</span>:</strong> External field—favors spins pointing in the field direction.</p></li>
</ul>
<p>Each spin looks at its neighbors and the external field; it feels pressure to align with both. Spins influence each other and, together, reach collective consistency. The interplay between spin–spin interaction and the external field creates the rich behavior—including hysteresis and remanence—that we see in real magnets.</p>
<section id="explore-the-model">
<h3>Explore the Model<a class="headerlink" href="#explore-the-model" title="Link to this heading">#</a></h3>
<p>Three numerical experiments let you explore ferromagnetism with the 2D Ising model. <strong>Run the cells in order</strong> (top to bottom). Each experiment has a short description followed by a code cell—run the code to launch the interactive widget or plot.</p>
<ol class="arabic simple">
<li><p><strong>Experiment 1</strong>: Spin configuration — watch domains form and break as you change <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p></li>
<li><p><strong>Experiment 2</strong>: Hysteresis loop — sweep <span class="math notranslate nohighlight">\(B\)</span> and see how <span class="math notranslate nohighlight">\(M\)</span> lags behind; compare below, near, and above <span class="math notranslate nohighlight">\(T_c\)</span>.</p></li>
<li><p><strong>Experiment 3</strong>: Curie–Weiss law — measure <span class="math notranslate nohighlight">\(M(T)\)</span> at fixed <span class="math notranslate nohighlight">\(B\)</span> and fit to extract <span class="math notranslate nohighlight">\(T_c\)</span>.</p></li>
</ol>
<p><strong>Setup:</strong> Run the setup cell below first, then run the <code class="docutils literal notranslate"><span class="pre">IsingSimulator</span></code> cell. All three experiments use this Monte Carlo engine. You only need to run each once; then run each experiment’s code cell to launch its widget.</p>
<div class="seealso dropdown admonition">
<p class="admonition-title">For the curious: Monte Carlo and the code</p>
<p><strong>Why Monte Carlo?</strong> We want to sample spin configurations with probability proportional to <span class="math notranslate nohighlight">\(e^{-E/k_B T}\)</span> (Boltzmann distribution). We cannot enumerate all <span class="math notranslate nohighlight">\(2^{L^2}\)</span> states. Instead, we build a <em>Markov chain</em>: start from some configuration, repeatedly propose small changes, and accept or reject them so that the chain converges to the Boltzmann distribution.</p>
<p><strong>Two algorithms in <code class="docutils literal notranslate"><span class="pre">IsingSimulator</span></code></strong></p>
<p>The class uses two different update schemes, each suited to a different task:</p>
<ol class="arabic">
<li><p><strong>Metropolis algorithm</strong> (<code class="docutils literal notranslate"><span class="pre">update</span></code> → <code class="docutils literal notranslate"><span class="pre">_update_kernel</span></code>): Used for the <em>step-by-step</em> spin-configuration widget (Experiment 1).</p>
<ul>
<li><p><strong>Propose:</strong> Pick a random spin <span class="math notranslate nohighlight">\(i\)</span> and flip it: <span class="math notranslate nohighlight">\(s_i \to -s_i\)</span>.</p></li>
<li><p><strong>Energy change:</strong> Only the chosen spin and its 4 neighbors contribute. Flipping <span class="math notranslate nohighlight">\(s_i\)</span> changes the energy by</p>
<div class="math notranslate nohighlight">
\[\Delta E = 2J\, s_i \sum_{\text{neighbors}} s_j + 2h\, s_i\]</div>
</li>
<li><p><strong>Accept:</strong> With probability <span class="math notranslate nohighlight">\(P = \min(1, e^{-\Delta E/T})\)</span>. If <span class="math notranslate nohighlight">\(\Delta E \le 0\)</span> (energy decreases or stays same), always accept. If <span class="math notranslate nohighlight">\(\Delta E &gt; 0\)</span>, accept with probability <span class="math notranslate nohighlight">\(e^{-\Delta E/T}\)</span>.</p></li>
<li><p><strong>One “sweep”</strong> = <span class="math notranslate nohighlight">\(L^2\)</span> such attempts (one per site on average).</p></li>
</ul>
<p>In the code, <code class="docutils literal notranslate"><span class="pre">_update_kernel</span></code> picks a random site, computes <code class="docutils literal notranslate"><span class="pre">ΔE</span></code> from the neighbor sum, and flips if <code class="docutils literal notranslate"><span class="pre">np.random.random()</span> <span class="pre">&lt;=</span> <span class="pre">min(1,</span> <span class="pre">exp(-ΔE/T))</span></code>.</p>
</li>
<li><p><strong>Checkerboard Gibbs sampling</strong> (<code class="docutils literal notranslate"><span class="pre">equilibrate</span></code>): Used for <em>fast equilibration</em> in hysteresis and Curie–Weiss runs (Experiments 2 and 3).</p>
<ul class="simple">
<li><p><strong>Divide</strong> the lattice into two sublattices (checkerboard: even vs odd <span class="math notranslate nohighlight">\((i+j)\)</span>).</p></li>
<li><p><strong>Update</strong> all spins on one sublattice <em>simultaneously</em>. Each spin <span class="math notranslate nohighlight">\(s_i\)</span> is drawn from the conditional distribution given its 4 neighbors—no rejections.</p></li>
<li><p><strong>Probability</strong> that <span class="math notranslate nohighlight">\(s_i = +1\)</span> given neighbors: <span class="math notranslate nohighlight">\(P_{\uparrow} = 1/(1 + e^{-2\beta H})\)</span>, where <span class="math notranslate nohighlight">\(H = J \sum_{\text{neighbors}} s_j + h\)</span>.</p></li>
<li><p><strong>Alternate</strong> between the two sublattices for many sweeps.</p></li>
</ul>
<p>This is faster than Metropolis because many spins update per sweep and there are no rejections.</p>
</li>
</ol>
<p><strong>Method guide</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Role</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></td>
<td><p>Store <span class="math notranslate nohighlight">\(J\)</span>, <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(h\)</span>, system size; call <code class="docutils literal notranslate"><span class="pre">reset</span></code> to create initial random spins.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">reset</span></code></p></td>
<td><p>Initialize <code class="docutils literal notranslate"><span class="pre">spin_config</span></code> (random ±1 or from given array).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">update(steps)</span></code></p></td>
<td><p>Run <code class="docutils literal notranslate"><span class="pre">steps</span></code> Metropolis single-spin flips; default one sweep (<span class="math notranslate nohighlight">\(L^2\)</span> steps).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">equilibrate(sweeps)</span></code></p></td>
<td><p>Run <code class="docutils literal notranslate"><span class="pre">sweeps</span></code> checkerboard Gibbs sweeps to reach equilibrium.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">magnetization</span></code></p></td>
<td><p>Return (mean <span class="math notranslate nohighlight">\(M\)</span>, std) over batches for error bars.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Physical units:</strong> <span class="math notranslate nohighlight">\(k_B = 1\)</span>; <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(J\)</span> in the same units; <span class="math notranslate nohighlight">\(h \propto B\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numba</span><span class="w"> </span><span class="kn">import</span> <span class="n">njit</span>

<span class="c1"># Setup</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.close_figures = False

<span class="c1"># Define the IsingSimulator class</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IsingSimulator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Numba-accelerated 2D Ising model Monte Carlo simulator.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">system_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">spin_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span> <span class="o">=</span> <span class="n">system_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">J</span>  <span class="c1"># coupling constant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>  <span class="c1"># temperature (k_B=1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>  <span class="c1"># external field (Ising convention)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">spin_config</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">magnetization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;(mean, std) over batches. mean = batch mean of per-config magnetization; std for error bars.&quot;&quot;&quot;</span>
        <span class="n">m_per_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">m_per_batch</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="n">m_per_batch</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_per_batch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spin_config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">spin_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">spin_config</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">):</span>
                <span class="n">spin_config</span> <span class="o">=</span> <span class="n">spin_config</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">spin_config</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span> <span class="o">=</span> <span class="n">spin_config</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">spin_config</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Single-spin Metropolis update (for step-by-step teaching demo).&quot;&quot;&quot;</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span>
        <span class="k">if</span> <span class="n">steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">L</span>
        <span class="n">s_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_kernel</span><span class="p">(</span><span class="n">s_flat</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span> <span class="o">=</span> <span class="n">s_flat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">equilibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sweeps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checkerboard Gibbs update for fast equilibration. Use for hysteresis/magnetization curves.&quot;&quot;&quot;</span>
        <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_size</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">masks</span> <span class="o">=</span> <span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="o">~</span><span class="n">mask</span><span class="p">]</span>  <span class="c1"># even and odd sublattices</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sweeps</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">mask</span> <span class="ow">in</span> <span class="n">masks</span><span class="p">:</span>
                <span class="n">sum_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">J</span> <span class="o">*</span> <span class="n">sum_n</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
                <span class="n">P_up</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">H</span><span class="p">))</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">new_spin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span> <span class="o">&lt;</span> <span class="n">P_up</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">s</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_spin</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span> <span class="o">=</span> <span class="n">s</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update display.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_fig&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_spin_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ax</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">toolbar_visible</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">footer_visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_im</span><span class="o">.</span><span class="n">set_data</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_draw_spin_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">batch_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw spin config with common styling. Returns the AxesImage for in-place updates.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_config</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># -1→black, +1→white</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
            <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Spin configuration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;Black: spin ↓, White: spin ↑&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">im</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@njit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_update_kernel</span><span class="p">(</span><span class="n">s_flat</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compiled MC update. s_flat: (N, L*L) int8 spin config, modified in place.&quot;&quot;&quot;</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">n_sites</span> <span class="o">=</span> <span class="n">s_flat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">L</span> <span class="o">*</span> <span class="n">L</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_sites</span><span class="p">)</span>
                <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">L</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">L</span>
                <span class="n">il</span> <span class="o">=</span> <span class="p">((</span><span class="n">i1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="n">i2</span>
                <span class="n">ir</span> <span class="o">=</span> <span class="p">((</span><span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="n">i2</span>
                <span class="n">ib</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="p">(</span><span class="n">i2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span>
                <span class="n">it</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="p">(</span><span class="n">i2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span>
                <span class="n">s_i</span> <span class="o">=</span> <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="n">sum_n</span> <span class="o">=</span> <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">il</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">ir</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">ib</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">it</span><span class="p">]</span>
                <span class="n">dE</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">s_i</span> <span class="o">*</span> <span class="n">sum_n</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">s_i</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span> <span class="o">/</span> <span class="n">T</span><span class="p">)):</span>
                    <span class="n">s_flat</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">s_i</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="experiment-1-spin-configuration">
<h3>Experiment 1: Spin configuration<a class="headerlink" href="#experiment-1-spin-configuration" title="Link to this heading">#</a></h3>
<p>Watch the Ising lattice evolve in real time. The simulation shows a 64×64 grid of spins: <strong>black</strong> = spin ↓, <strong>white</strong> = spin ↑.</p>
<p><strong>Run the cell below</strong> (after the IsingSimulator cell). Then:</p>
<ul class="simple">
<li><p><strong>Play</strong> / <strong>Pause</strong>: Start or stop the Monte Carlo dynamics.</p></li>
<li><p><strong>T slider</strong>: Temperature (in units of <span class="math notranslate nohighlight">\(J/k_B\)</span>). The Curie temperature <span class="math notranslate nohighlight">\(T_c \approx 2.27\)</span>.</p></li>
<li><p><strong>B slider</strong>: External magnetic field.</p></li>
<li><p><strong>Refresh</strong>: Randomize the spin configuration and start fresh.</p></li>
</ul>
<p><strong>What to observe:</strong></p>
<ul class="simple">
<li><p>At <strong>low T</strong> (e.g. 1.5): Spins align into domains; the lattice stays mostly one color. This is the ferromagnetic phase.</p></li>
<li><p>At <strong>high T</strong> (e.g. 3.5): Spins flip randomly; no long-range order. This is the paramagnetic phase.</p></li>
<li><p>Near <strong><span class="math notranslate nohighlight">\(T_c\)</span></strong>: Domains form and break up; you see the transition between order and disorder.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">Play</span><span class="p">,</span> <span class="n">Button</span><span class="p">,</span> <span class="n">FloatSlider</span><span class="p">,</span> <span class="n">VBox</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">IsingSimulator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">system_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Create figure once for reuse</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sim</span><span class="o">.</span><span class="n">spin_config</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># -1→1 (white), +1→0 (black)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">spine</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Spin configuration&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;Black: spin ↓, White: spin ↑&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;320px&#39;</span><span class="p">,</span> <span class="n">min_width</span><span class="o">=</span><span class="s1">&#39;320px&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;340px&#39;</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">update_display</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">B</span>
    <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sim</span><span class="o">.</span><span class="n">spin_config</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="c1"># Play widget – click its play button to animate; drives step count for update_display</span>
<span class="n">play</span> <span class="o">=</span> <span class="n">Play</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">999999999</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">show_repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">T_slider</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;T:&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">B_slider</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;B:&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">on_change</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">update_display</span><span class="p">(</span><span class="n">play</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">T_slider</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">B_slider</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">play</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_change</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">T_slider</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_change</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">B_slider</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_change</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Initial display (observe only fires on change)</span>
<span class="k">with</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">on_refresh</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sim</span><span class="o">.</span><span class="n">spin_config</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>

<span class="n">refresh_btn</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">icon</span><span class="o">=</span><span class="s1">&#39;refresh&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Refresh&#39;</span><span class="p">)</span>
<span class="n">refresh_btn</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_refresh</span><span class="p">)</span>

<span class="n">controls_col</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">play</span><span class="p">,</span> <span class="n">T_slider</span><span class="p">,</span> <span class="n">B_slider</span><span class="p">,</span> <span class="n">refresh_btn</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;flex-start&#39;</span><span class="p">,</span> <span class="n">flex</span><span class="o">=</span><span class="s1">&#39;0 0 auto&#39;</span><span class="p">))</span>
<span class="n">main_hbox</span> <span class="o">=</span> <span class="n">HBox</span><span class="p">([</span><span class="n">out</span><span class="p">,</span> <span class="n">controls_col</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">gap</span><span class="o">=</span><span class="s1">&#39;8px&#39;</span><span class="p">,</span> <span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;flex-start&#39;</span><span class="p">))</span>

<span class="c1"># out created first so update_display/on_refresh can reference it</span>
<span class="n">display</span><span class="p">(</span><span class="n">main_hbox</span><span class="p">)</span>
<span class="c1"># Prevent inline backend from auto-displaying fig at cell end (would leak to cell output)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0a28722a338b4e85b43d37012bc29cc3", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="experiment-2-hysteresis-loop">
<h3>Experiment 2: Hysteresis loop<a class="headerlink" href="#experiment-2-hysteresis-loop" title="Link to this heading">#</a></h3>
<p>The magnetization <span class="math notranslate nohighlight">\(M\)</span> of a ferromagnet depends on the <em>history</em> of the applied field <span class="math notranslate nohighlight">\(B\)</span>, not just its current value. Sweeping <span class="math notranslate nohighlight">\(B\)</span> up and down traces a <strong>hysteresis loop</strong>.</p>
<p><strong>Run the cell below</strong> to display the interactive hysteresis plot. Use the <strong>T slider</strong> to change the temperature.</p>
<p><strong>What to observe:</strong></p>
<ul class="simple">
<li><p><strong>Below <span class="math notranslate nohighlight">\(T_c\)</span></strong> (e.g. T = 1.5): A fat loop. As <span class="math notranslate nohighlight">\(B\)</span> goes from +2 → −2 → +2, <span class="math notranslate nohighlight">\(M\)</span> lags behind. When <span class="math notranslate nohighlight">\(B = 0\)</span>, <span class="math notranslate nohighlight">\(M\)</span> is nonzero—that’s <strong>remanence</strong>. The field needed to bring <span class="math notranslate nohighlight">\(M\)</span> to zero is the <strong>coercive field</strong> <span class="math notranslate nohighlight">\(B_c\)</span>.</p></li>
<li><p><strong>Near <span class="math notranslate nohighlight">\(T_c\)</span></strong> (e.g. T = 2.3): The loop shrinks; the system is at the critical point.</p></li>
<li><p><strong>Above <span class="math notranslate nohighlight">\(T_c\)</span></strong> (e.g. T = 3.5): The loop collapses to a single line—paramagnetic response. No memory; <span class="math notranslate nohighlight">\(M\)</span> follows <span class="math notranslate nohighlight">\(B\)</span> reversibly.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">FloatSlider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="c1"># Hysteresis parameters</span>
<span class="n">B_MIN</span><span class="p">,</span> <span class="n">B_MAX</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span>
<span class="n">EQUIL_SWEEPS</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Build B sequence: -2→2, 2→-2, ...</span>
<span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">B_MIN</span><span class="p">,</span> <span class="n">B_MAX</span><span class="p">,</span> <span class="n">N_STEPS</span><span class="p">)</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">B_MAX</span><span class="p">,</span> <span class="n">B_MIN</span><span class="p">,</span> <span class="n">N_STEPS</span><span class="p">)</span>
<span class="n">B_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>

<span class="nd">@interact</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">FloatSlider</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;T:&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">},</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_hysteresis</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">IsingSimulator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">system_size</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">B_list</span><span class="p">,</span> <span class="n">M_list</span><span class="p">,</span> <span class="n">M_err_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">B_values</span><span class="p">:</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">h</span><span class="p">,</span> <span class="n">T</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="n">sweeps</span><span class="o">=</span><span class="n">EQUIL_SWEEPS</span><span class="p">)</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">m_std</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">magnetization</span>
        <span class="n">B_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">M_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">M_err_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_std</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">B_list</span><span class="p">,</span> <span class="n">M_list</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">M_err_list</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hysteresis (T=</span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ed68d58ca0947f99651c8a4bf4eedc7", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="experiment-3-curieweiss-law">
<h3>Experiment 3: Curie–Weiss law<a class="headerlink" href="#experiment-3-curieweiss-law" title="Link to this heading">#</a></h3>
<p>Above the Curie temperature <span class="math notranslate nohighlight">\(T_c\)</span>, the material is paramagnetic. For a small fixed field <span class="math notranslate nohighlight">\(B\)</span>, the magnetization follows the <strong>Curie–Weiss law</strong>:</p>
<div class="math notranslate nohighlight">
\[M \propto \frac{1}{T - T_c}\]</div>
<p>As <span class="math notranslate nohighlight">\(T \to T_c^+\)</span>, <span class="math notranslate nohighlight">\(M\)</span> diverges—a signature of the phase transition.</p>
<p><strong>Run the cell below</strong> to simulate <span class="math notranslate nohighlight">\(M\)</span> vs <span class="math notranslate nohighlight">\(T\)</span> at a fixed small <span class="math notranslate nohighlight">\(B\)</span> value, fit the high-temperature data to the Curie–Weiss form, and extract <span class="math notranslate nohighlight">\(T_c\)</span>. The fit (dashed line) applies to <span class="math notranslate nohighlight">\(T &gt; T_c\)</span>; the vertical line marks the fitted <span class="math notranslate nohighlight">\(T_c\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># M vs T at fixed small B: Curie-Weiss law M ∝ 1/(T - T_c) above T_c</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="n">B_FIXED</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">T_HIGH</span><span class="p">,</span> <span class="n">T_LOW</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.4</span>
<span class="n">N_T</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span>
<span class="n">EQUIL_SWEEPS</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Scan from high T toward low T</span>
<span class="n">T_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">T_HIGH</span><span class="p">,</span> <span class="n">T_LOW</span><span class="p">,</span> <span class="n">N_T</span><span class="p">)</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">IsingSimulator</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">system_size</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T_HIGH</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">B_FIXED</span><span class="p">)</span>
<span class="n">M_list</span><span class="p">,</span> <span class="n">M_err_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_values</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">B_FIXED</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="n">sweeps</span><span class="o">=</span><span class="n">EQUIL_SWEEPS</span><span class="p">)</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">m_std</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">magnetization</span>
    <span class="n">M_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">M_err_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_std</span><span class="p">)</span>

<span class="n">M_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M_list</span><span class="p">)</span>
<span class="n">M_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">M_err_list</span><span class="p">)</span>

<span class="c1"># Curie-Weiss: M = C / (T - T_c) for T &gt; T_c (paramagnetic phase)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">curie_weiss</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Tc</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">C</span> <span class="o">/</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">Tc</span><span class="p">)</span>

<span class="c1"># Fit only high-T points (well above T_c ≈ 2.27)</span>
<span class="n">mask_fit</span> <span class="o">=</span> <span class="n">T_values</span> <span class="o">&gt;</span> <span class="mf">2.6</span>
<span class="n">T_fit</span> <span class="o">=</span> <span class="n">T_values</span><span class="p">[</span><span class="n">mask_fit</span><span class="p">]</span>
<span class="n">M_fit</span> <span class="o">=</span> <span class="n">M_values</span><span class="p">[</span><span class="n">mask_fit</span><span class="p">]</span>
<span class="n">sigma_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">M_err</span><span class="p">[</span><span class="n">mask_fit</span><span class="p">],</span> <span class="mf">1e-6</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.27</span><span class="p">)</span>  <span class="c1"># initial C, T_c</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>  <span class="c1"># C&gt;0, T_c in [1.5, 2.5]</span>
<span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">curie_weiss</span><span class="p">,</span> <span class="n">T_fit</span><span class="p">,</span> <span class="n">M_fit</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_fit</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">C_fit</span><span class="p">,</span> <span class="n">Tc_fit</span> <span class="o">=</span> <span class="n">popt</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">header_visible</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;M vs T at B=</span><span class="si">{</span><span class="n">B_FIXED</span><span class="si">}</span><span class="s1">: Curie-Weiss law M ∝ 1/(T−T_c)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">M_values</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">M_err</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
<span class="n">T_smooth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.01</span><span class="o">*</span><span class="n">Tc_fit</span><span class="p">,</span> <span class="n">T_HIGH</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_smooth</span><span class="p">,</span> <span class="n">curie_weiss</span><span class="p">(</span><span class="n">T_smooth</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Curie-Weiss fit: T$_c$=</span><span class="si">{</span><span class="n">Tc_fit</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">Tc_fit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;T$_c$ ≈ </span><span class="si">{</span><span class="n">Tc_fit</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">T_LOW</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">T_HIGH</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../images/63db7a68c589f26c19c4d0102c08cf2d0e7b4f85d25f0ff12426c083387a2487.png" src="../images/63db7a68c589f26c19c4d0102c08cf2d0e7b4f85d25f0ff12426c083387a2487.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch32_maxwells-equations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="32-7-paramagnetism.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">32-7 Paramagnetism</p>
      </div>
    </a>
    <a class="right-next"
       href="../ch33_electromagnetic-waves/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chap 33: Electromagnetic Waves</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lecture-notes">Lecture Notes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#curie-temperature">Curie temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis">Hysteresis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-the-memory-of-magnets">Project: The Memory of Magnets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-model">Explore the Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-1-spin-configuration">Experiment 1: Spin configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-2-hysteresis-loop">Experiment 2: Hysteresis loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-3-curieweiss-law">Experiment 3: Curie–Weiss law</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yi-Zhuang You
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2027.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    <div class="extra_footer">
  <p class="text-muted">Lecture notes prepared with <a href="https://cursor.com/home?from=agents" target="_blank" rel="noopener">Cursor AI</a>.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>